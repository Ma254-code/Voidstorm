<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auftragsverwaltung</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <div id="login" class="max-w-md mx-auto mt-20 p-6 bg-white rounded-xl shadow-md">
    <h2 class="text-2xl font-bold mb-4 text-center">Login</h2>
    <input type="text" id="username" placeholder="Benutzername" class="w-full border px-3 py-2 mb-3 rounded" />
    <input type="password" id="password" placeholder="Passwort" class="w-full border px-3 py-2 mb-3 rounded" />
    <button onclick="login()" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">Login</button>
    <div id="loginMsg" class="text-red-500 mt-2 text-center"></div>
  </div>

  <div id="main" class="hidden max-w-xl mx-auto mt-10">
    <h2 class="text-3xl font-bold mb-6 text-center">Aufträge</h2>
    <div id="auftraege" class="space-y-4"></div>
  </div>

  <script>
    const users = [
      { username: 'Admin', password: 'Admin' },
      { username: 'Benn1', password: 'Benn1' },
      { username: 'luca', password: 'Voidstorm1532' }
    ];

    let currentUser = null;

    // Lade Aufträge aus LocalStorage oder Default
    let auftraege = JSON.parse(localStorage.getItem('auftraege')) || [
      { id: 1, text: 'Script Auftrag 1', owner: null },
      { id: 2, text: 'Script Auftrag 2', owner: null },
      { id: 3, text: 'Script Auftrag 3', owner: null },
    ];

    function saveAuftraege() {
      localStorage.setItem('auftraege', JSON.stringify(auftraege));
    }

    function login() {
      const u = document.getElementById('username').value;
      const p = document.getElementById('password').value;
      const found = users.find(user => user.username === u && user.password === p);

      if (found) {
        currentUser = found.username;
        document.getElementById('login').classList.add('hidden');
        document.getElementById('main').classList.remove('hidden');
        renderAuftraege();
      } else {
        document.getElementById('loginMsg').innerText = 'Falsche Login-Daten';
      }
    }

    function renderAuftraege() {
      const container = document.getElementById('auftraege');
      container.innerHTML = '';
      auftraege.forEach(a => {
        const div = document.createElement('div');
        div.className = 'bg-white p-4 rounded shadow';
        div.innerHTML = `
          <div class="text-lg font-semibold mb-2">${a.text}</div>
          <div class="mb-2">Status: ${a.owner ? `<span class="text-green-600 font-bold">Übernommen von ${a.owner}</span>` : '<span class="text-gray-500">Frei</span>'}</div>
          <div>
            ${a.owner === null ? `<button onclick="uebernehmen(${a.id})" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Übernehmen</button>` : ''}
            ${a.owner === currentUser ? `<button onclick="freigeben(${a.id})" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-2">Freigeben</button>` : ''}
          </div>
        `;
        container.appendChild(div);
      });
    }

    function uebernehmen(id) {
      const a = auftraege.find(a => a.id === id);
      if (a.owner === null) {
        a.owner = currentUser;
        saveAuftraege();
        renderAuftraege();
      }
    }

    function freigeben(id) {
      const a = auftraege.find(a => a.id === id);
      if (a.owner === currentUser) {
        a.owner = null;
        saveAuftraege();
        renderAuftraege();
      }
    }
  </script>
</body>
</html>

