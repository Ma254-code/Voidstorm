<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auftragsverwaltung</title>
  <style>
    body { font-family: sans-serif; background: #f0f0f0; padding: 20px; }
    #login, #main { max-width: 500px; margin: auto; padding: 20px; background: white; border-radius: 8px; }
    .hidden { display: none; }
    button { padding: 8px 12px; margin: 5px; }
    .auftrag { border: 1px solid #ddd; padding: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <div id="login">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Benutzername" /><br>
    <input type="password" id="password" placeholder="Passwort" /><br>
    <button onclick="login()">Login</button>
    <div id="loginMsg"></div>
  </div>

  <div id="main" class="hidden">
    <h2>Aufträge</h2>
    <div id="auftraege"></div>
  </div>

  <script>
    const users = [
      { username: 'Admin', password: 'Admin' },
      { username: 'Benn1', password: 'Benn1' },
      { username: 'luca', password: 'Voidstorm1532' }
    ];

    let currentUser = null;

    // Lade Aufträge aus LocalStorage oder verwende Default
    let auftraege = JSON.parse(localStorage.getItem('auftraege')) || [
      { id: 1, text: 'Script Auftrag 1', owner: null },
      { id: 2, text: 'Script Auftrag 2', owner: null },
      { id: 3, text: 'Script Auftrag 3', owner: null },
    ];

    function saveAuftraege() {
      localStorage.setItem('auftraege', JSON.stringify(auftraege));
    }

    function login() {
      const u = document.getElementById('username').value;
      const p = document.getElementById('password').value;
      const found = users.find(user => user.username === u && user.password === p);

      if (found) {
        currentUser = found.username;
        document.getElementById('login').classList.add('hidden');
        document.getElementById('main').classList.remove('hidden');
        renderAuftraege();
      } else {
        document.getElementById('loginMsg').innerText = 'Falsche Login-Daten';
      }
    }

    function renderAuftraege() {
      const container = document.getElementById('auftraege');
      container.innerHTML = '';
      auftraege.forEach(a => {
        const div = document.createElement('div');
        div.className = 'auftrag';
        div.innerHTML = `
          <strong>${a.text}</strong><br>
          Status: ${a.owner ? 'Übernommen von ' + a.owner : 'Frei'}<br>
          ${a.owner === null ? `<button onclick="uebernehmen(${a.id})">Übernehmen</button>` : ''}
          ${a.owner === currentUser ? `<button onclick="freigeben(${a.id})">Freigeben</button>` : ''}
        `;
        container.appendChild(div);
      });
    }

    function uebernehmen(id) {
      const a = auftraege.find(a => a.id === id);
      if (a.owner === null) {
        a.owner = currentUser;
        saveAuftraege();
        renderAuftraege();
      }
    }

    function freigeben(id) {
      const a = auftraege.find(a => a.id === id);
      if (a.owner === currentUser) {
        a.owner = null;
        saveAuftraege();
        renderAuftraege();
      }
    }
  </script>
</body>
</html>
